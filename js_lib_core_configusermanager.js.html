<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js/lib/core/configusermanager.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: js/lib/core/configusermanager.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Manager user config file
 * @class ConfigUserManager
 */
function ConfigUserManager(){
	/**
   * Path to workspace folder by default
   * @type {String}
   */
   Cloudbook.workspace = process.env['HOME'] + "/Cloudbook/";
  /**
   * File where store all project project metadata
   * @type {String}
   */
   Cloudbook.userconfigpath = Cloudbook.workspace + ".conf";

}
ConfigUserManager.prototype.initialize = function initialize() {
	var fs = require('fs');
    if ( ! fs.existsSync(Cloudbook.userconfigpath) ){
    	this.saveUserConfig(this.emptyConfig());
  	}
};

ConfigUserManager.prototype.emptyConfig = function emptyConfig() {
	return {projects:[]};
};

ConfigUserManager.prototype.defaultProject = function defaultProject() {
	return {date:new Date(), name:"", path:""};
};

/**
 * Create initial information of project on userconfig 
 * @param  {String} projectname [description]
 */
ConfigUserManager.prototype.newProject = function newProject(projectname) {
  // Save project into userconfig
  var userconfig = this.getUserConfig();
  var tempproject = {name:projectname,path:Project.Info.projectpath};
  userconfig.projects.push($.extend(this.defaultProject(),tempproject));
  this.saveUserConfig(userconfig);
};

/**
 * Save user config on file system
 * @param  {Object[]} jsoninfo JSON with user config and projects metadata
 * @return {Boolean}          Success
 */
ConfigUserManager.prototype.saveUserConfig = function saveUserConfig(jsoninfo) {
  var fs = require('fs');
  fs.writeFileSync(Cloudbook.userconfigpath,JSON.stringify(jsoninfo,null,"\t"),{encoding:"utf-8"});
  return true;
};

/**
 * Return JSON object with user configuration and metadata from projects
 * @return {Object[]} JSON with user config
 */
ConfigUserManager.prototype.getUserConfig = function getUserConfig() {
  var fs = require('fs');
  return JSON.parse(fs.readFileSync(Cloudbook.userconfigpath));
};


ConfigUserManager.prototype.getLastProjects = function getLastProjects() {
	var allprojects = this.getUserConfig();
	return allprojects.projects.sort(function(a,b){return new Date(a.date) - new Date(b.date)});
};

CBUtil.createNameSpace('application.config.user');
application.config.user = CBUtil.singleton(ConfigUserManager);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Backend.html">Backend</a></li><li><a href="CBObject.html">CBObject</a></li><li><a href="CBSection.html">CBSection</a></li><li><a href="ConfigUserManager.html">ConfigUserManager</a></li><li><a href="Controller.html">Controller</a></li><li><a href="StorageManager.html">StorageManager</a></li><li><a href="TextBox.html">TextBox</a></li><li><a href="Translator.html">Translator</a></li><li><a href="UI.html">UI</a></li><li><a href="Util.html">Util</a></li></ul><h3>Namespaces</h3><ul><li><a href="application.html">application</a></li><li><a href="application.backend.html">backend</a></li><li><a href="application.controller.html">controller</a></li><li><a href="application.storagemanager.html">storagemanager</a></li><li><a href="application.ui.html">ui</a></li><li><a href="Cloudbook.html">Cloudbook</a></li><li><a href="Cloudbook.Actions.html">Actions</a></li><li><a href="Cloudbook.Sections.html">Sections</a></li><li><a href="Cloudbook.UI.html">UI</a></li><li><a href="Project.html">Project</a></li><li><a href="Project.Data.html">Data</a></li><li><a href="Project.Info.html">Info</a></li></ul><h3>Global</h3><ul><li><a href="global.html#getInstance">getInstance</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta3</a> on Tue Mar 24 2015 12:37:37 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
